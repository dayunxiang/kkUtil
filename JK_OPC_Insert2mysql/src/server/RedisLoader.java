package server;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.TimerTask;

import redis.RedisClient;
import model.RedisPool;
import util.JsonReader;
import util.LogWriter;
import vo.Redis;

public class RedisLoader extends TimerTask {

	public RedisLoader() {
	}

	@Override
	public void run() {
		// String redisjson = new ConfgReader("./redisdata").readTxtFile();
		RedisClient client = new RedisClient();
		String redisjson = client.Pop();
//		 String redisjson =
//		 "{'time':1431116079,'data':[{'id':'cdyz_ys_input_cod','type':4,'value':'217.5926'},{'id':'cdyz_ys_input_nh4n','type':4,'value':'56.0764'},{'id':'cdyz_ys_input_ll','type':4,'value':'748.8426'},{'id':'cdyz_ys_input_lllj','type':4,'value':'1056870.1'},{'id':'cdyz_ys_tsbdl1','type':4,'value':'0.0579'},{'id':'cdyz_ys_tsbdl2','type':4,'value':'29.1088'},{'id':'cdyz_ys_tsbdl3','type':4,'value':'0.0579'},{'id':'cdyz_ys_tsbdl4','type':4,'value':'47.8588'},{'id':'cdyz_ys_cgsywc1','type':4,'value':'0.0'},{'id':'cdyz_ys_cgsywc2','type':4,'value':'0.011'},{'id':'cdyz_ys_input_yw1','type':4,'value':'6.2182'},{'id':'cdyz_ys_input_yw2','type':4,'value':'0.0087'},{'id':'cdyz_ys_cgszt1','type':5,'value':'false'},{'id':'cdyz_ys_cgszt2','type':5,'value':'false'},{'id':'cdyz_ys_tsbzt1','type':5,'value':'true'},{'id':'cdyz_ys_tsbzt2','type':5,'value':'false'},{'id':'cdyz_ys_tsbzt3','type':5,'value':'true'},{'id':'cdyz_ys_tsbzt4','type':5,'value':'false'},{'id':'cdyz_ys_input_orp','type':4,'value':'28.8628'},{'id':'cdyz_ys_input_ss','type':4,'value':'0.0'},{'id':'cdyz_ys_input_ph','type':4,'value':'0.0'},{'id':'cdyz_ys_xgsywc','type':4,'value':'0.9149'},{'id':'cdyz_ys_xgszt','type':5,'value':'true'},{'id':'cdyz_ys_xgsssjzt','type':5,'value':'true'},{'id':'cdyz_ys_scjbqzt1','type':5,'value':'true'},{'id':'cdyz_ys_scjbqzt2','type':5,'value':'true'},{'id':'cdyz_ys_gfjzt1','type':5,'value':'false'},{'id':'cdyz_ys_gfjzt2','type':5,'value':'false'},{'id':'cdyz_ys_gfjzt3','type':5,'value':'false'},{'id':'cdyz_ys_ssflqzt','type':5,'value':'false'},{'id':'cdyz_ys_yhg1do1','type':4,'value':'0.0'},{'id':'cdyz_ys_yhg1do2','type':4,'value':'2.8935'},{'id':'cdyz_ys_yhg1mlss','type':4,'value':'341.4352'},{'id':'cdyz_ys_yhg1nhlbzt1','type':5,'value':'true'},{'id':'cdyz_ys_yhg1nhlbzt2','type':5,'value':'true'},{'id':'cdyz_ys_yhg1csymzt','type':5,'value':'false'},{'id':'cdyz_ys_yhg2do1','type':4,'value':'0.7581'},{'id':'cdyz_ys_yhg2do2','type':4,'value':'2.8067'},{'id':'cdyz_ys_yhg2mlss','type':4,'value':'2743.0554'},{'id':'cdyz_ys_yhg2nhlbzt1','type':5,'value':'true'},{'id':'cdyz_ys_yhg2nhlbzt2','type':5,'value':'true'},{'id':'cdyz_ys_yhg2csymzt','type':5,'value':'false'},{'id':'cdyz_ys_wnjm1','type':4,'value':'3.5'},{'id':'cdyz_ys_wnjm2','type':4,'value':'3.5'},{'id':'cdyz_ys_output_cod','type':4,'value':'40.7986'},{'id':'cdyz_ys_output_nh4n','type':4,'value':'0.1042'},{'id':'cdyz_ys_output_ll','type':4,'value':'629.6875'},{'id':'cdyz_ys_output_lllj','type':4,'value':'944876.25'},{'id':'cdyz_ys_ecc1gxnjzt','type':5,'value':'true'},{'id':'cdyz_ys_ecc2gxnjzt','type':5,'value':'true'},{'id':'cdyz_ys_hlwnjyw','type':4,'value':'3.3218'},{'id':'cdyz_ys_hlj1whlbzt','type':5,'value':'false'},{'id':'cdyz_ys_hlj2whlbzt','type':5,'value':'false'},{'id':'cdyz_ys_hlj3whlbzt','type':5,'value':'true'},{'id':'cdyz_ys_hlj1sywnhlbzt','type':5,'value':'true'},{'id':'cdyz_ys_hlj2sywnhlbzt','type':5,'value':'true'},{'id':'cdyz_ys_tscj1bqjzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj2bqjzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj1jlbzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj2jlbzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj3jlbzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj4jlbzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj1jbjzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj2jbjzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj1wnnsjzt','type':5,'value':'true'},{'id':'cdyz_ys_tscj1pamjybzt','type':5,'value':'true'},{'id':'cdyz_ys_tscj1kqysjzt','type':5,'value':'true'},{'id':'cdyz_ys_tscj1wnssjzt','type':5,'value':'true'},{'id':'cdyz_ys_tscj1csbzt','type':5,'value':'true'},{'id':'cdyz_ys_tscj2wnnsjzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj2pamjybzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj2kqysjzt','type':5,'value':'true'},{'id':'cdyz_ys_tscj2wnssjzt','type':5,'value':'false'},{'id':'cdyz_ys_tscj2csbzt','type':5,'value':'false'},{'id':'cdyz_ys_yyc1tjqzt1','type':5,'value':'true'},{'id':'cdyz_ys_yyc1tjqzt2','type':5,'value':'false'},{'id':'cdyz_ys_yyc1tjqzt3','type':5,'value':'true'},{'id':'cdyz_ys_yyc1tjqzt4','type':5,'value':'true'},{'id':'cdyz_ys_yyc1jbqzt5','type':5,'value':'false'},{'id':'cdyz_ys_yyc2tjqzt1','type':5,'value':'true'},{'id':'cdyz_ys_yyc2tjqzt2','type':5,'value':'true'},{'id':'cdyz_ys_yyc2tjqzt3','type':5,'value':'true'},{'id':'cdyz_ys_yyc2tjqzt4','type':5,'value':'true'},{'id':'cdyz_ys_yyc2jbqzt5','type':5,'value':'true'},{'id':'cdyz_ys_yhg1bqjzt1','type':5,'value':'true'},{'id':'cdyz_ys_yhg1bqjzt2','type':5,'value':'true'},{'id':'cdyz_ys_yhg1bqjzt3','type':5,'value':'true'},{'id':'cdyz_ys_yhg1bqjzt4','type':5,'value':'true'},{'id':'cdyz_ys_yhg2bqjzt1','type':5,'value':'true'},{'id':'cdyz_ys_yhg2bqjzt2','type':5,'value':'true'},{'id':'cdyz_ys_yhg2bqjzt3','type':5,'value':'true'},{'id':'cdyz_ys_yhg2bqjzt4','type':5,'value':'true'},{'id':'cdyz_ys_gfjf_gfjzt1','type':5,'value':'true'},{'id':'cdyz_ys_gfjf_gfjzt2','type':5,'value':'false'},{'id':'cdyz_ys_gfjf_gfjzt3','type':5,'value':'true'},{'id':'cdyz_ys_gfjf_gfjll1','type':4,'value':'72.0'},{'id':'cdyz_ys_gfjf_gfjll2','type':4,'value':'0.0'},{'id':'cdyz_ys_gfjf_gfjll3','type':4,'value':'71.0'},{'id':'cdyz_ys_gfjf_gfjdl1','type':4,'value':'26.0'},{'id':'cdyz_ys_gfjf_gfjdl2','type':4,'value':'0.0'},{'id':'cdyz_ys_gfjf_gfjdl3','type':4,'value':'25.0'},{'id':'cdyz_ys_gfjf_gfjsv1','type':4,'value':'50.0'},{'id':'cdyz_ys_gfjf_gfjsv2','type':4,'value':'80.0'},{'id':'cdyz_ys_gfjf_gfjsv3','type':4,'value':'50.0'}]}";
//		System.out.println("得到数据：" + redisjson);
//		 String redisjson =
//		 "2015-01-13 10-25-22 : {'time':1431115923,'data':[{'id':'cdyz_dz_lcfjdl4','type':4,'value':'0.0'},{'id':'cdyz_dz_lcfjpl4','type':4,'value':'0.0'},{'id':'cdyz_dz_lcfjdl5','type':4,'value':'63.77'},{'id':'cdyz_dz_lcfjpl5','type':4,'value':'0.0'},{'id':'cdyz_dz_lcfjdl6','type':4,'value':'55.96'},{'id':'cdyz_dz_lcfjpl6','type':4,'value':'36.84'},{'id':'cdyz_dz_cass1_lcfjzgll1','type':4,'value':'960.65'},{'id':'cdyz_dz_cass1_lcfjzgll2','type':4,'value':'890.62'},{'id':'cdyz_dz_cass1_lcfjzgfy1','type':4,'value':'490.74'},{'id':'cdyz_dz_cass1_lcfjzgfy2','type':4,'value':'424.48'},{'id':'cdyz_dz_mlss1','type':4,'value':'0.0'},{'id':'cdyz_dz_mlss2','type':4,'value':'4392.62'},{'id':'cdyz_dz_mlss3','type':4,'value':'5958.17'},{'id':'cdyz_dz_mlss4','type':4,'value':'4027.78'},{'id':'cdyz_dz_do1','type':4,'value':'0.0'},{'id':'cdyz_dz_do2','type':4,'value':'1.59'},{'id':'cdyz_dz_do3','type':4,'value':'1.36'},{'id':'cdyz_dz_do4','type':4,'value':'0.07'},{'id':'cdyz_dz_yw1','type':4,'value':'4.95'},{'id':'cdyz_dz_yw2','type':4,'value':'4.44'},{'id':'cdyz_dz_yw3','type':4,'value':'5.01'},{'id':'cdyz_dz_yw4','type':4,'value':'4.61'},{'id':'cdyz_dz_lcfjzt4','type':1,'value':'0'},{'id':'cdyz_dz_lcfjzt5','type':1,'value':'1'},{'id':'cdyz_dz_lcfjzt6','type':1,'value':'1'},{'id':'cdyz_dz_cass1jsfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass2jsfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass3jsfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass4jsfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass1jqfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass2jqfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass3jqfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass4jqfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass1jsfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass2jsfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass3jsfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass4jsfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass1jqfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass2jqfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass3jqfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass4jqfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass1jbqzt1','type':1,'value':'0'},{'id':'cdyz_dz_cass1jbqzt2','type':1,'value':'0'},{'id':'cdyz_dz_cass2jbqzt1','type':1,'value':'1'},{'id':'cdyz_dz_cass2jbqzt2','type':1,'value':'1'},{'id':'cdyz_dz_cass3jbqzt1','type':1,'value':'1'},{'id':'cdyz_dz_cass3jbqzt2','type':1,'value':'1'},{'id':'cdyz_dz_cass4jbqzt1','type':1,'value':'0'},{'id':'cdyz_dz_cass4jbqzt2','type':1,'value':'0'},{'id':'cdyz_dz_cass1hlbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass1sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass1bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_cass2hlbzt','type':1,'value':'1'},{'id':'cdyz_dz_cass2sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass2bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_cass3hlbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass3sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass3bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_cass4hlbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass4sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass4bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_lcfjdl1','type':4,'value':'56.37'},{'id':'cdyz_dz_lcfjpl1','type':4,'value':'31.32'},{'id':'cdyz_dz_lcfjdl2','type':4,'value':'57.29'},{'id':'cdyz_dz_lcfjpl2','type':4,'value':'48.99'},{'id':'cdyz_dz_lcfjdl3','type':4,'value':'0.0'},{'id':'cdyz_dz_lcfjpl3','type':4,'value':'0.0'},{'id':'cdyz_dz_cass2_lcfjzgll1','type':4,'value':'1217.71'},{'id':'cdyz_dz_cass2_lcfjzgll2','type':4,'value':'987.9'},{'id':'cdyz_dz_cass2_lcfjzgfy1','type':4,'value':'0.0'},{'id':'cdyz_dz_cass2_lcfjzgfy2','type':4,'value':'0.0'},{'id':'cdyz_dz_mlss5','type':4,'value':'0.0'},{'id':'cdyz_dz_mlss6','type':4,'value':'49.19'},{'id':'cdyz_dz_mlss7','type':4,'value':'4476.27'},{'id':'cdyz_dz_mlss8','type':4,'value':'2905.09'},{'id':'cdyz_dz_do5','type':4,'value':'1.85'},{'id':'cdyz_dz_do6','type':4,'value':'0.01'},{'id':'cdyz_dz_do7','type':4,'value':'1.57'},{'id':'cdyz_dz_do8','type':4,'value':'0.0'},{'id':'cdyz_dz_yw5','type':4,'value':'5.0'},{'id':'cdyz_dz_yw6','type':4,'value':'4.4'},{'id':'cdyz_dz_yw7','type':4,'value':'4.55'},{'id':'cdyz_dz_yw8','type':4,'value':'5.22'},{'id':'cdyz_dz_lcfjzt1','type':1,'value':'1'},{'id':'cdyz_dz_lcfjzt2','type':1,'value':'1'},{'id':'cdyz_dz_lcfjzt3','type':1,'value':'0'},{'id':'cdyz_dz_cass5jsfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass6jsfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass7jsfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass8jsfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass5jqfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass6jqfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass7jqfzt_open','type':1,'value':'1'},{'id':'cdyz_dz_cass8jqfzt_open','type':1,'value':'0'},{'id':'cdyz_dz_cass5jsfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass6jsfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass7jsfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass8jsfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass5jqfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass6jqfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass7jqfzt_close','type':1,'value':'0'},{'id':'cdyz_dz_cass8jqfzt_close','type':1,'value':'1'},{'id':'cdyz_dz_cass5jbqzt1','type':1,'value':'1'},{'id':'cdyz_dz_cass5jbqzt2','type':1,'value':'1'},{'id':'cdyz_dz_cass6jbqzt1','type':1,'value':'0'},{'id':'cdyz_dz_cass6jbqzt2','type':1,'value':'0'},{'id':'cdyz_dz_cass7jbqzt1','type':1,'value':'1'},{'id':'cdyz_dz_cass7jbqzt2','type':1,'value':'1'},{'id':'cdyz_dz_cass8jbqzt1','type':1,'value':'0'},{'id':'cdyz_dz_cass8jbqzt2','type':1,'value':'0'},{'id':'cdyz_dz_cass5hlbzt','type':1,'value':'1'},{'id':'cdyz_dz_cass5sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass5bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_cass6hlbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass6sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass6bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_cass7hlbzt','type':1,'value':'1'},{'id':'cdyz_dz_cass7sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass7bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_cass8hlbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass8sywnbzt','type':1,'value':'0'},{'id':'cdyz_dz_cass8bsqzt','type':1,'value':'0'},{'id':'cdyz_dz_cgsywc1','type':4,'value':'1.0'},{'id':'cdyz_dz_cgsywc2','type':4,'value':'0.02'},{'id':'cdyz_dz_input_cod','type':4,'value':'0.0'},{'id':'cdyz_dz_input_nh4n','type':4,'value':'0.0'},{'id':'cdyz_dz_input_yw','type':4,'value':'5.28'},{'id':'cdyz_dz_tsbpl4','type':4,'value':'50.0'},{'id':'cdyz_dz_cgszt1','type':4,'value':'0.0'},{'id':'cdyz_dz_cgszt2','type':4,'value':'0.0'},{'id':'cdyz_dz_cgsssdzt','type':1,'value':'0'},{'id':'cdyz_dz_tsbzt1','type':1,'value':'0'},{'id':'cdyz_dz_tsbzt2','type':1,'value':'1'},{'id':'cdyz_dz_tsbzt3','type':1,'value':'0'},{'id':'cdyz_dz_tsbzt4','type':1,'value':'1'},{'id':'cdyz_dz_input_ph','type':4,'value':'0.0'},{'id':'cdyz_dz_xgszt1','type':1,'value':'1'},{'id':'cdyz_dz_xgszt2','type':1,'value':'1'},{'id':'cdyz_dz_xgsssdzt','type':1,'value':'0'},{'id':'cdyz_dz_cscjbqzt1','type':1,'value':'1'},{'id':'cdyz_dz_cscjbqzt2','type':1,'value':'1'},{'id':'cdyz_dz_xsbzt1','type':1,'value':'1'},{'id':'cdyz_dz_xsbzt2','type':1,'value':'1'},{'id':'cdyz_dz_ssflqzt1','type':1,'value':'1'},{'id':'cdyz_dz_ssflqzt2','type':1,'value':'1'},{'id':'cdyz_dz_out_cod','type':4,'value':'0.0'},{'id':'cdyz_dz_out_nh4n','type':4,'value':'0.0'},{'id':'cdyz_dz_out_ll','type':4,'value':'1163.54'},{'id':'cdyz_dz_out_lllj','type':4,'value':'1163.54'},{'id':'cdyz_dz_tsbpl4','type':4,'value':'50.0'},{'id':'cdyz_dz_xdc1zt','type':5,'value':'false'},{'id':'cdyz_dz_xdc2zt','type':5,'value':'false'},{'id':'cdyz_dz_zshyb1zt','type':5,'value':'false'},{'id':'cdyz_dz_zshyb2zt','type':5,'value':'false'}]}";
		if (redisjson != null && !redisjson.equals("PONG")
				&& !redisjson.equals("")) {
			SimpleDateFormat dateFormat = new SimpleDateFormat(
					"yyyy-MM-dd HH-mm-ss");
			LogWriter.writeRedisLog(dateFormat.format(new Date()) + " : "
					+ redisjson);
			client.addCounter();
			Redis redis = new JsonReader(redisjson).getRedis();
			if (redis == null)
				return;
			RedisPool.getRedisPool().putIn(redis);
		}
	}

}
